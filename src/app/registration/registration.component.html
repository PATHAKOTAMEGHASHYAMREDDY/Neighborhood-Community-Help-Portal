<div class="auth-wrapper">
  <!-- Centered Auth Forms -->
  <div class="auth-forms">
    <div class="form-container">
      <!-- Tab Navigation -->
      <div class="tab-navigation">
        <button
          class="tab-button"
          [class.active]="activeTab === 'login'"
          (click)="switchTab('login')"
          type="button">
          Login
        </button>
        <button
          class="tab-button"
          [class.active]="activeTab === 'signup'"
          (click)="switchTab('signup')"
          type="button">
          Sign Up
        </button>
      </div>

      <!-- Login Form -->
      <form *ngIf="activeTab === 'login'" class="auth-form" (ngSubmit)="onLogin()">
        <h2 class="form-title">Welcome Back</h2>
        <p class="form-subtitle">Login to continue to your account</p>

        <div class="form-group">
          <label for="login-email">Email / Phone</label>
          <div class="input-wrapper">
            <span class="input-icon">ğŸ“§</span>
            <input
              type="text"
              id="login-email"
              [(ngModel)]="loginData.contact_info"
              name="contact_info"
              placeholder="Enter your email or phone"
              required>
          </div>
        </div>

        <div class="form-group">
          <label for="login-password">Password</label>
          <div class="input-wrapper">
            <span class="input-icon">ğŸ”’</span>
            <input
              type="password"
              [type]="showLoginPassword ? 'text' : 'password'"
              id="login-password"
              [(ngModel)]="loginData.password"
              name="password"
              placeholder="Enter your password"
              required>
            <button
              type="button"
              class="toggle-password"
              (click)="showLoginPassword = !showLoginPassword">
              {{ showLoginPassword ? 'ğŸ‘' : 'ğŸ”’' }}
            </button>
          </div>
        </div>

        <div class="forgot-password-wrapper">
          <a class="forgot-password-link" (click)="onForgotPassword()">
            Forgot Password?
          </a>
        </div>

        <div class="form-group">
          <label>Select Your Role</label>
          <div class="role-selection">
            <label class="role-option">
              <input
                type="radio"
                name="loginRole"
                value="Resident"
                [(ngModel)]="loginData.role"
                required>
              <span class="role-card">
                <span class="role-icon">ğŸ </span>
                <span class="role-name">Resident</span>
              </span>
            </label>

            <label class="role-option">
              <input
                type="radio"
                name="loginRole"
                value="Helper"
                [(ngModel)]="loginData.role"
                required>
              <span class="role-card">
                <span class="role-icon">ğŸ¤</span>
                <span class="role-name">Helper</span>
              </span>
            </label>

            <label class="role-option">
              <input
                type="radio"
                name="loginRole"
                value="Admin"
                [(ngModel)]="loginData.role"
                required>
              <span class="role-card">
                <span class="role-icon">ğŸ›¡ï¸</span>
                <span class="role-name">Admin</span>
              </span>
            </label>
          </div>
        </div>

        <div *ngIf="errorMessage" class="error-message">
          <span class="message-icon">âš ï¸</span>
          {{ errorMessage }}
        </div>

        <button type="submit" class="submit-button" [disabled]="isLoading">
          <span *ngIf="!isLoading">Login</span>
          <span *ngIf="isLoading">Logging in...</span>
        </button>
      </form>

      <!-- Sign Up Form -->
      <form *ngIf="activeTab === 'signup'" class="auth-form" (ngSubmit)="onSignup()">
        <h2 class="form-title">Create Account</h2>
        <p class="form-subtitle">Join our community today</p>

        <div class="form-group">
          <label for="signup-name">Full Name</label>
          <div class="input-wrapper">
            <span class="input-icon">ğŸ‘¤</span>
            <input
              type="text"
              id="signup-name"
              [(ngModel)]="signupData.name"
              name="name"
              placeholder="Enter your full name"
              required>
          </div>
        </div>

        <div class="form-group">
          <label for="signup-email">Email / Phone</label>
          <div class="input-wrapper">
            <span class="input-icon">ğŸ“§</span>
            <input
              type="text"
              id="signup-email"
              [(ngModel)]="signupData.contact_info"
              name="contact_info"
              placeholder="Enter your email or phone"
              required>
          </div>
        </div>

        <div class="form-group">
          <label for="signup-location">Location</label>
          <div class="input-wrapper">
            <span class="input-icon">ğŸ“</span>
            <input
              type="text"
              id="signup-location"
              [(ngModel)]="signupData.location"
              name="location"
              placeholder="Enter your location"
              required>
          </div>
        </div>

        <div class="form-group">
          <label for="signup-password">Password</label>
          <div class="input-wrapper">
            <span class="input-icon">ğŸ”’</span>
            <input
              type="password"
              [type]="showSignupPassword ? 'text' : 'password'"
              id="signup-password"
              [(ngModel)]="signupData.password"
              name="password"
              placeholder="Create a password"
              required>
            <button
              type="button"
              class="toggle-password"
              (click)="showSignupPassword = !showSignupPassword">
              {{ showSignupPassword ? 'ğŸ‘' : 'ğŸ”’' }}
            </button>
          </div>
        </div>

        <div class="form-group">
          <label for="signup-confirm-password">Confirm Password</label>
          <div class="input-wrapper">
            <span class="input-icon">ğŸ”’</span>
            <input
              type="password"
              [type]="showConfirmPassword ? 'text' : 'password'"
              id="signup-confirm-password"
              [(ngModel)]="signupData.confirmPassword"
              name="confirmPassword"
              placeholder="Confirm your password"
              required>
            <button
              type="button"
              class="toggle-password"
              (click)="showConfirmPassword = !showConfirmPassword">
              {{ showConfirmPassword ? 'ğŸ‘' : 'ğŸ”’' }}
            </button>
          </div>
        </div>

        <div class="form-group">
          <label>Select Your Role</label>
          <div class="role-selection signup-roles">
            <label class="role-option">
              <input
                type="radio"
                name="signupRole"
                value="Resident"
                [(ngModel)]="signupData.role"
                required>
              <span class="role-card detailed">
                <span class="role-icon">ğŸ </span>
                <span class="role-info">
                  <span class="role-name">Resident</span>
                  <span class="role-desc">Post help requests</span>
                </span>
              </span>
            </label>

            <label class="role-option">
              <input
                type="radio"
                name="signupRole"
                value="Helper"
                [(ngModel)]="signupData.role"
                required>
              <span class="role-card detailed">
                <span class="role-icon">ğŸ¤</span>
                <span class="role-info">
                  <span class="role-name">Helper</span>
                  <span class="role-desc">Offer assistance</span>
                </span>
              </span>
            </label>
          </div>
        </div>

        <div *ngIf="errorMessage" class="error-message">
          <span class="message-icon">âš ï¸</span>
          {{ errorMessage }}
        </div>

        <div *ngIf="successMessage" class="success-message">
          <span class="message-icon">âœ“</span>
          {{ successMessage }}
        </div>

        <button type="submit" class="submit-button" [disabled]="isLoading">
          <span *ngIf="!isLoading">Create Account</span>
          <span *ngIf="isLoading">Creating account...</span>
        </button>
      </form>
    </div>
  </div>
</div>


<!-- Forgot Password Modal -->
<div class="modal-overlay" *ngIf="showForgotPasswordModal" (click)="closeForgotPasswordModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>Reset Password</h2>
      <button class="close-btn" (click)="closeForgotPasswordModal()" type="button">Ã—</button>
    </div>

    <div class="modal-body">
      <!-- Step 1: Enter Email -->
      <div *ngIf="forgotPasswordStep === 'email'" class="reset-step">
        <p class="step-description">Enter your email address to receive an OTP</p>

        <div class="form-group">
          <label for="reset-email">Email Address</label>
          <div class="input-wrapper">
            <span class="input-icon">ğŸ“§</span>
            <input
              type="email"
              id="reset-email"
              [(ngModel)]="forgotPasswordData.email"
              name="resetEmail"
              placeholder="Enter your email"
              required>
          </div>
        </div>

        <div *ngIf="forgotPasswordError" class="error-message">
          <span class="message-icon">âš ï¸</span>
          {{ forgotPasswordError }}
        </div>

        <div *ngIf="forgotPasswordMessage" class="success-message">
          <span class="message-icon">âœ“</span>
          {{ forgotPasswordMessage }}
        </div>

        <button class="submit-button" (click)="sendOTP()" [disabled]="isLoading" type="button">
          <span *ngIf="!isLoading">Send OTP</span>
          <span *ngIf="isLoading">Sending...</span>
        </button>
      </div>

      <!-- Step 2: Enter OTP -->
      <div *ngIf="forgotPasswordStep === 'otp'" class="reset-step">
        <p class="step-description">Enter the 6-digit OTP sent to {{ forgotPasswordData.email }}</p>

        <div class="form-group">
          <label for="reset-otp">OTP Code</label>
          <div class="input-wrapper">
            <span class="input-icon">ğŸ”‘</span>
            <input
              type="text"
              id="reset-otp"
              [(ngModel)]="forgotPasswordData.otp"
              name="resetOtp"
              placeholder="Enter 6-digit OTP"
              maxlength="6"
              required>
          </div>
        </div>

        <div *ngIf="forgotPasswordError" class="error-message">
          <span class="message-icon">âš ï¸</span>
          {{ forgotPasswordError }}
        </div>

        <div *ngIf="forgotPasswordMessage" class="success-message">
          <span class="message-icon">âœ“</span>
          {{ forgotPasswordMessage }}
        </div>

        <button class="submit-button" (click)="verifyOTP()" [disabled]="isLoading" type="button">
          <span *ngIf="!isLoading">Verify OTP</span>
          <span *ngIf="isLoading">Verifying...</span>
        </button>

        <button class="link-button" (click)="forgotPasswordStep = 'email'" type="button">
          â† Back to email
        </button>
      </div>

      <!-- Step 3: Set New Password -->
      <div *ngIf="forgotPasswordStep === 'newPassword'" class="reset-step">
        <p class="step-description">Create a new password for your account</p>

        <div class="form-group">
          <label for="new-password">New Password</label>
          <div class="input-wrapper">
            <span class="input-icon">ğŸ”’</span>
            <input
              type="password"
              id="new-password"
              [(ngModel)]="forgotPasswordData.newPassword"
              name="newPassword"
              placeholder="Enter new password"
              required>
          </div>
        </div>

        <div class="form-group">
          <label for="confirm-new-password">Confirm Password</label>
          <div class="input-wrapper">
            <span class="input-icon">ğŸ”’</span>
            <input
              type="password"
              id="confirm-new-password"
              [(ngModel)]="forgotPasswordData.confirmPassword"
              name="confirmNewPassword"
              placeholder="Confirm new password"
              required>
          </div>
        </div>

        <div *ngIf="forgotPasswordError" class="error-message">
          <span class="message-icon">âš ï¸</span>
          {{ forgotPasswordError }}
        </div>

        <div *ngIf="forgotPasswordMessage" class="success-message">
          <span class="message-icon">âœ“</span>
          {{ forgotPasswordMessage }}
        </div>

        <button class="submit-button" (click)="resetPassword()" [disabled]="isLoading" type="button">
          <span *ngIf="!isLoading">Reset Password</span>
          <span *ngIf="isLoading">Resetting...</span>
        </button>
      </div>
    </div>
  </div>
</div>
