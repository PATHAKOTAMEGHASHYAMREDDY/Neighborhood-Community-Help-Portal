<div class="auth-wrapper">
  <div class="auth-forms">
    <div class="form-container">

      <!-- Tab Navigation -->
      <div class="tab-navigation">
        <button class="tab-button" [class.active]="activeTab === 'login'" (click)="switchTab('login')" type="button">
          Login
        </button>
        <button class="tab-button" [class.active]="activeTab === 'signup'" (click)="switchTab('signup')" type="button">
          Sign Up
        </button>
      </div>

      <!-- Login Form -->
      <form *ngIf="activeTab === 'login'" class="auth-form" (ngSubmit)="onLogin()">
        <h2 class="form-title">Welcome Back</h2>
        <p class="form-subtitle">Login to continue to your account</p>

        <div class="form-group">
          <label>Email / Phone</label>
          <div class="input-wrapper">
            <span class="input-icon"><mat-icon>email</mat-icon></span>
            <input type="text" [(ngModel)]="loginData.contact_info" name="contact_info" placeholder="Enter your email or phone" required>
          </div>
        </div>

        <div class="form-group">
          <label>Password</label>
          <div class="input-wrapper">
            <span class="input-icon"><mat-icon>lock</mat-icon></span>
            <input [type]="showLoginPassword ? 'text' : 'password'" [(ngModel)]="loginData.password" name="password" placeholder="Enter your password" required>
            <button type="button" class="toggle-password" (click)="showLoginPassword = !showLoginPassword">
              <mat-icon>{{ showLoginPassword ? 'visibility' : 'visibility_off' }}</mat-icon>
            </button>
          </div>
        </div>

        <div class="forgot-password-wrapper">
          <a class="forgot-password-link" (click)="onForgotPassword()">Forgot Password?</a>
        </div>

        <div class="form-group">
          <label>Select Your Role</label>
          <div class="role-selection">
            <label class="role-option">
              <input type="radio" name="loginRole" value="Resident" [(ngModel)]="loginData.role" required>
              <span class="role-card">
                <span class="role-icon"><mat-icon>home</mat-icon></span>
                <span class="role-name">Resident</span>
              </span>
            </label>

            <label class="role-option">
              <input type="radio" name="loginRole" value="Helper" [(ngModel)]="loginData.role" required>
              <span class="role-card">
                <span class="role-icon"><mat-icon>handshake</mat-icon></span>
                <span class="role-name">Helper</span>
              </span>
            </label>

            <label class="role-option">
              <input type="radio" name="loginRole" value="Admin" [(ngModel)]="loginData.role" required>
              <span class="role-card">
                <span class="role-icon"><mat-icon>security</mat-icon></span>
                <span class="role-name">Admin</span>
              </span>
            </label>
          </div>
        </div>

        <div *ngIf="errorMessage" class="error-message">
          <span class="message-icon"><mat-icon>warning</mat-icon></span>
          {{ errorMessage }}
        </div>

        <button type="submit" class="submit-button" [disabled]="isLoading">
          <span *ngIf="!isLoading">Login</span>
          <span *ngIf="isLoading">Logging in...</span>
        </button>
      </form>

      <!-- Sign Up Form -->
      <form *ngIf="activeTab === 'signup'" class="auth-form" (ngSubmit)="onSignup()">
        <h2 class="form-title">Create Account</h2>
        <p class="form-subtitle">Join our community today</p>

        <div class="form-group">
          <label>Full Name</label>
          <div class="input-wrapper">
            <span class="input-icon"><mat-icon>person</mat-icon></span>
            <input type="text" [(ngModel)]="signupData.name" name="name" placeholder="Enter your full name" required>
          </div>
        </div>

        <div class="form-group">
          <label>Email / Phone</label>
          <div class="input-wrapper">
            <span class="input-icon"><mat-icon>email</mat-icon></span>
            <input type="text" [(ngModel)]="signupData.contact_info" name="contact_info" placeholder="Enter your email or phone" required>
          </div>
        </div>

        <div class="form-group">
          <label>Location</label>
          <div class="input-wrapper">
            <span class="input-icon"><mat-icon>place</mat-icon></span>
            <input type="text" [(ngModel)]="signupData.location" name="location" placeholder="Enter your location" required>
          </div>
        </div>

        <div class="form-group">
          <label>Password</label>
          <div class="input-wrapper">
            <span class="input-icon"><mat-icon>lock</mat-icon></span>
            <input [type]="showSignupPassword ? 'text' : 'password'" [(ngModel)]="signupData.password" name="password" placeholder="Create a password" required>
            <button type="button" class="toggle-password" (click)="showSignupPassword = !showSignupPassword">
              <mat-icon>{{ showSignupPassword ? 'visibility' : 'visibility_off' }}</mat-icon>
            </button>
          </div>
        </div>

        <div class="form-group">
          <label>Confirm Password</label>
          <div class="input-wrapper">
            <span class="input-icon"><mat-icon>lock</mat-icon></span>
            <input [type]="showConfirmPassword ? 'text' : 'password'" [(ngModel)]="signupData.confirmPassword" name="confirmPassword" placeholder="Confirm your password" required>
            <button type="button" class="toggle-password" (click)="showConfirmPassword = !showConfirmPassword">
              <mat-icon>{{ showConfirmPassword ? 'visibility' : 'visibility_off' }}</mat-icon>
            </button>
          </div>
        </div>

        <div class="form-group">
          <label>Select Your Role</label>
          <div class="role-selection signup-roles">
            <label class="role-option">
              <input type="radio" name="signupRole" value="Resident" [(ngModel)]="signupData.role" required>
              <span class="role-card detailed">
                <span class="role-icon"><mat-icon>home</mat-icon></span>
                <span class="role-info">
                  <span class="role-name">Resident</span>
                  <span class="role-desc">Post help requests</span>
                </span>
              </span>
            </label>

            <label class="role-option">
              <input type="radio" name="signupRole" value="Helper" [(ngModel)]="signupData.role" required>
              <span class="role-card detailed">
                <span class="role-icon"><mat-icon>handshake</mat-icon></span>
                <span class="role-info">
                  <span class="role-name">Helper</span>
                  <span class="role-desc">Offer assistance</span>
                </span>
              </span>
            </label>
          </div>
        </div>

        <div *ngIf="errorMessage" class="error-message">
          <span class="message-icon"><mat-icon>warning</mat-icon></span>
          {{ errorMessage }}
        </div>

        <div *ngIf="successMessage" class="success-message">
          <span class="message-icon"><mat-icon>check_circle</mat-icon></span>
          {{ successMessage }}
        </div>

        <button type="submit" class="submit-button" [disabled]="isLoading">
          <span *ngIf="!isLoading">Create Account</span>
          <span *ngIf="isLoading">Creating account...</span>
        </button>
      </form>
    </div>
  </div>
</div>

<!-- Forgot Password Modal -->
<div class="modal-overlay" *ngIf="showForgotPasswordModal" (click)="closeForgotPasswordModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>Reset Password</h2>
      <button class="close-btn" (click)="closeForgotPasswordModal()" type="button">Ã—</button>
    </div>

    <div class="modal-body">

      <div *ngIf="forgotPasswordStep === 'email'" class="reset-step">
        <div class="form-group">
          <div class="input-wrapper">
            <span class="input-icon"><mat-icon>email</mat-icon></span>
            <input type="email" [(ngModel)]="forgotPasswordData.email" placeholder="Enter your email" required>
          </div>
        </div>

        <div *ngIf="forgotPasswordError" class="error-message">
          <span class="message-icon"><mat-icon>warning</mat-icon></span>
          {{ forgotPasswordError }}
        </div>

        <div *ngIf="forgotPasswordMessage" class="success-message">
          <span class="message-icon"><mat-icon>check_circle</mat-icon></span>
          {{ forgotPasswordMessage }}
        </div>

        <button class="submit-button" (click)="sendOTP()" [disabled]="isLoading" type="button">
          Send OTP
        </button>
      </div>

      <div *ngIf="forgotPasswordStep === 'otp'" class="reset-step">
        <div class="form-group">
          <div class="input-wrapper">
            <span class="input-icon"><mat-icon>key</mat-icon></span>
            <input type="text" [(ngModel)]="forgotPasswordData.otp" placeholder="Enter OTP" maxlength="6" required>
          </div>
        </div>

        <button class="submit-button" (click)="verifyOTP()" [disabled]="isLoading" type="button">
          Verify OTP
        </button>

        <button class="link-button" (click)="forgotPasswordStep = 'email'" type="button">
          <mat-icon>arrow_back</mat-icon>
          Back to email
        </button>
      </div>

      <div *ngIf="forgotPasswordStep === 'newPassword'" class="reset-step">
        <div class="form-group">
          <div class="input-wrapper">
            <span class="input-icon"><mat-icon>lock</mat-icon></span>
            <input type="password" [(ngModel)]="forgotPasswordData.newPassword" placeholder="New password" required>
          </div>
        </div>

        <div class="form-group">
          <div class="input-wrapper">
            <span class="input-icon"><mat-icon>lock</mat-icon></span>
            <input type="password" [(ngModel)]="forgotPasswordData.confirmPassword" placeholder="Confirm password" required>
          </div>
        </div>

        <button class="submit-button" (click)="resetPassword()" [disabled]="isLoading" type="button">
          Reset Password
        </button>
      </div>

    </div>
  </div>
</div>
