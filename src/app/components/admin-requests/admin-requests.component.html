<div class="admin-container">
  <!-- Sidebar -->
  <aside class="sidebar" [class.collapsed]="isSidebarCollapsed">
    <div class="sidebar-header">
      <h2>Admin Panel</h2>
      <button class="toggle-btn" (click)="toggleSidebar()" type="button">â˜°</button>
    </div>

    <nav class="sidebar-nav">
      <a routerLink="/admin" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}" class="nav-item">
        <span class="nav-icon">ğŸ“Š</span>
        <span class="nav-text">Dashboard</span>
      </a>
      <a routerLink="/admin/users" routerLinkActive="active" class="nav-item">
        <span class="nav-icon">ğŸ‘¥</span>
        <span class="nav-text">Users</span>
      </a>
      <a routerLink="/admin/requests" routerLinkActive="active" class="nav-item">
        <span class="nav-icon">ğŸ“‹</span>
        <span class="nav-text">Requests</span>
      </a>
      <a routerLink="/admin/analytics" routerLinkActive="active" class="nav-item">
        <span class="nav-icon">ğŸ“ˆ</span>
        <span class="nav-text">Analytics</span>
      </a>
      <a (click)="logout()" class="nav-item logout">
        <span class="nav-icon">ğŸšª</span>
        <span class="nav-text">Logout</span>
      </a>
    </nav>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <header class="dashboard-header">
      <div class="header-content">
        <div>
          <h1>Request Management</h1>
          <p>Monitor and manage all help requests</p>
        </div>
      </div>
    </header>

    <div class="dashboard-content">
      <!-- Loading State -->
      <div class="loading-container" *ngIf="isLoading">
        <div class="loading-spinner"></div>
        <p>Loading requests...</p>
      </div>

      <!-- Content -->
      <div *ngIf="!isLoading">
        <!-- Stats Cards -->
        <div class="stats-grid">
          <div class="stat-card total">
            <div class="stat-icon">ğŸ“‹</div>
            <div class="stat-info">
              <h3>Total Requests</h3>
              <p class="stat-number">{{ totalRequests }}</p>
            </div>
          </div>
          <div class="stat-card pending">
            <div class="stat-icon">â³</div>
            <div class="stat-info">
              <h3>Pending</h3>
              <p class="stat-number">{{ pendingRequests }}</p>
            </div>
          </div>
          <div class="stat-card accepted">
            <div class="stat-icon">âœ‹</div>
            <div class="stat-info">
              <h3>Accepted</h3>
              <p class="stat-number">{{ acceptedRequests }}</p>
            </div>
          </div>
          <div class="stat-card in-progress">
            <div class="stat-icon">ğŸ”„</div>
            <div class="stat-info">
              <h3>In-Progress</h3>
              <p class="stat-number">{{ inProgressRequests }}</p>
            </div>
          </div>
          <div class="stat-card completed">
            <div class="stat-icon">âœ…</div>
            <div class="stat-info">
              <h3>Completed</h3>
              <p class="stat-number">{{ completedRequests }}</p>
            </div>
          </div>
        </div>

        <!-- Filters -->
        <div class="filters-section">
          <div class="search-box">
            <input 
              type="text" 
              placeholder="Search by title, category, or resident..." 
              (input)="onSearchChange($event)"
              class="search-input">
          </div>
          <div class="status-filters">
            <button [class.active]="filterStatus === 'All'" (click)="onStatusFilterChange('All')" class="filter-btn" type="button">All</button>
            <button [class.active]="filterStatus === 'Pending'" (click)="onStatusFilterChange('Pending')" class="filter-btn" type="button">Pending</button>
            <button [class.active]="filterStatus === 'Accepted'" (click)="onStatusFilterChange('Accepted')" class="filter-btn" type="button">Accepted</button>
            <button [class.active]="filterStatus === 'In-progress'" (click)="onStatusFilterChange('In-progress')" class="filter-btn" type="button">In-Progress</button>
            <button [class.active]="filterStatus === 'Completed'" (click)="onStatusFilterChange('Completed')" class="filter-btn" type="button">Completed</button>
          </div>
        </div>

        <!-- Requests Table -->
        <div class="requests-table-container">
          <div class="no-data" *ngIf="filteredRequests.length === 0">
            <p>No requests found</p>
          </div>

          <table class="requests-table" *ngIf="filteredRequests.length > 0">
            <thead>
              <tr>
                <th>ID</th>
                <th>Title</th>
                <th>Category</th>
                <th>Resident</th>
                <th>Helper</th>
                <th>Status</th>
                <th>Created</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let request of filteredRequests">
                <td>#{{ request.id }}</td>
                <td class="title-cell">{{ request.title }}</td>
                <td><span class="category-badge">{{ request.category }}</span></td>
                <td>{{ request.resident_name || 'N/A' }}</td>
                <td>{{ request.helper_name || 'Unassigned' }}</td>
                <td>
                  <span class="status-badge" [ngClass]="getStatusClass(request.status)">
                    {{ request.status }}
                  </span>
                </td>
                <td>{{ request.created_at | date:'short' }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </main>
</div>
