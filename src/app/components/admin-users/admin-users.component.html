<div class="admin-container">
  <!-- Sidebar -->
  <aside class="sidebar" [class.collapsed]="isSidebarCollapsed">
    <div class="sidebar-header">
      <h2>Admin Panel</h2>
      <button class="toggle-btn" (click)="toggleSidebar()" type="button">â˜°</button>
    </div>

    <nav class="sidebar-nav">
      <a routerLink="/admin" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}" class="nav-item">
        <span class="nav-icon">ğŸ“Š</span>
        <span class="nav-text">Dashboard</span>
      </a>
      <a routerLink="/admin/users" routerLinkActive="active" class="nav-item">
        <span class="nav-icon">ğŸ‘¥</span>
        <span class="nav-text">Users</span>
      </a>
      <a routerLink="/admin/requests" routerLinkActive="active" class="nav-item">
        <span class="nav-icon">ğŸ“‹</span>
        <span class="nav-text">Requests</span>
      </a>
      <a routerLink="/admin/analytics" routerLinkActive="active" class="nav-item">
        <span class="nav-icon">ğŸ“ˆ</span>
        <span class="nav-text">Analytics</span>
      </a>
      <a (click)="logout()" class="nav-item logout">
        <span class="nav-icon">ğŸšª</span>
        <span class="nav-text">Logout</span>
      </a>
    </nav>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <header class="dashboard-header">
      <div class="header-content">
        <div>
          <h1>User Management</h1>
          <p>View and manage all platform users</p>
        </div>
      </div>
    </header>

    <div class="dashboard-content">
      <!-- Loading State -->
      <div class="loading-container" *ngIf="isLoading">
        <div class="loading-spinner"></div>
        <p>Loading users...</p>
      </div>

      <!-- Content -->
      <div *ngIf="!isLoading">
        <!-- Stats Cards -->
        <div class="stats-grid">
          <div class="stat-card total">
            <div class="stat-icon">ğŸ‘¥</div>
            <div class="stat-info">
              <h3>Total Users</h3>
              <p class="stat-number">{{ totalUsers }}</p>
            </div>
          </div>
          <div class="stat-card residents">
            <div class="stat-icon">ğŸ </div>
            <div class="stat-info">
              <h3>Residents</h3>
              <p class="stat-number">{{ totalResidents }}</p>
            </div>
          </div>
          <div class="stat-card helpers">
            <div class="stat-icon">ğŸ¤</div>
            <div class="stat-info">
              <h3>Helpers</h3>
              <p class="stat-number">{{ totalHelpers }}</p>
            </div>
          </div>
        </div>

        <!-- Filters -->
        <div class="filters-section">
          <div class="search-box">
            <input 
              type="text" 
              placeholder="Search by name, contact, or location..." 
              (input)="onSearchChange($event)"
              class="search-input">
          </div>
          <div class="role-filters">
            <button 
              [class.active]="filterRole === 'All'" 
              (click)="onRoleFilterChange('All')"
              class="filter-btn" type="button">All</button>
            <button 
              [class.active]="filterRole === 'Resident'" 
              (click)="onRoleFilterChange('Resident')"
              class="filter-btn" type="button">Residents</button>
            <button 
              [class.active]="filterRole === 'Helper'" 
              (click)="onRoleFilterChange('Helper')"
              class="filter-btn" type="button">Helpers</button>
          </div>
        </div>

        <!-- Users Table -->
        <div class="users-table-container">
          <div class="no-data" *ngIf="filteredUsers.length === 0">
            <p>No users found</p>
          </div>

          <table class="users-table" *ngIf="filteredUsers.length > 0">
            <thead>
              <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Contact Info</th>
                <th>Location</th>
                <th>Role</th>
                <th>Status</th>
                <th>Joined Date</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let user of filteredUsers">
                <td>#{{ user.id }}</td>
                <td class="name-cell">{{ user.name }}</td>
                <td>{{ user.contact_info }}</td>
                <td>{{ user.location }}</td>
                <td>
                  <span class="role-badge" [class.resident]="user.role === 'Resident'" [class.helper]="user.role === 'Helper'">
                    {{ user.role }}
                  </span>
                </td>
                <td>
                  <span class="status-badge" [class.blocked]="user.is_blocked" [class.active]="!user.is_blocked">
                    {{ user.is_blocked ? 'Blocked' : 'Active' }}
                  </span>
                </td>
                <td>{{ user.created_at | date:'short' }}</td>
                <td>
                  <button 
                    *ngIf="!user.is_blocked" 
                    (click)="blockUser(user.id)" 
                    class="action-btn block-btn"
                    type="button">
                    Block
                  </button>
                  <button 
                    *ngIf="user.is_blocked" 
                    (click)="unblockUser(user.id)" 
                    class="action-btn unblock-btn"
                    type="button">
                    Unblock
                  </button>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </main>
</div>
