<div class="dashboard-container">
  <!-- Sidebar -->
  <aside class="sidebar" [class.collapsed]="isSidebarCollapsed">
    <div class="sidebar-header">
      <h2>Community Help</h2>
      <button class="toggle-btn" (click)="toggleSidebar()" type="button">â˜°</button>
    </div>
    <nav class="sidebar-nav">
      <a routerLink="/requests" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}" class="nav-item">
        <span class="nav-icon">ğŸ“Š</span>
        <span class="nav-text">Dashboard</span>
      </a>
      <a routerLink="/requests" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}" class="nav-item">
        <span class="nav-icon">ğŸ“</span>
        <span class="nav-text">My Requests</span>
      </a>
      <a routerLink="/requests/new" routerLinkActive="active" class="nav-item">
        <span class="nav-icon">â•</span>
        <span class="nav-text">New Request</span>
      </a>
      <a routerLink="/profile" routerLinkActive="active" class="nav-item">
        <span class="nav-icon">ğŸ‘¤</span>
        <span class="nav-text">Profile</span>
      </a>
      <a routerLink="/my-reports" routerLinkActive="active" class="nav-item">
        <span class="nav-icon">ğŸ“„</span>
        <span class="nav-text">My Reports</span>
      </a>
      <a routerLink="/report-issue" routerLinkActive="active" class="nav-item">
        <span class="nav-icon">âš ï¸</span>
        <span class="nav-text">Report Issue</span>
      </a>
      <a (click)="logout()" class="nav-item logout">
        <span class="nav-icon">ğŸšª</span>
        <span class="nav-text">Logout</span>
      </a>
    </nav>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Header -->
    <header class="dashboard-header">
      <div class="header-content">
        <div>
          <h1>Resident Dashboard</h1>
          <p>Track and manage your help requests</p>
        </div>
        <button class="new-request-btn" (click)="navigateToNewRequest()" type="button">
          + New Help Request
        </button>
      </div>
    </header>

    <!-- Summary Cards -->
    <section class="summary-cards">
      <div class="summary-card total">
        <div class="card-icon">ğŸ“‹</div>
        <div class="card-content">
          <h3>Total Requests</h3>
          <p class="card-number">{{ totalRequests }}</p>
        </div>
      </div>
      <div class="summary-card pending">
        <div class="card-icon">â³</div>
        <div class="card-content">
          <h3>Pending</h3>
          <p class="card-number">{{ pendingCount }}</p>
        </div>
      </div>
      <div class="summary-card progress">
        <div class="card-icon">ğŸ”„</div>
        <div class="card-content">
          <h3>In-Progress</h3>
          <p class="card-number">{{ inProgressCount }}</p>
        </div>
      </div>
      <div class="summary-card completed">
        <div class="card-icon">âœ…</div>
        <div class="card-content">
          <h3>Completed</h3>
          <p class="card-number">{{ completedCount }}</p>
        </div>
      </div>
    </section>

    <!-- Requests List -->
    <section class="requests-section">
      <h2>My Help Requests</h2>
      <div class="loading" *ngIf="isLoading">
        <p>Loading requests...</p>
      </div>

      <div class="error-message" *ngIf="errorMessage">
        {{ errorMessage }}
      </div>

      <div class="no-requests" *ngIf="!isLoading && requests.length === 0">
        <p>You haven't created any requests yet.</p>
        <button class="new-request-btn" (click)="navigateToNewRequest()" type="button">
          Create Your First Request
        </button>
      </div>

      <div class="requests-grid" *ngIf="!isLoading && requests.length > 0">
        <div class="request-card" *ngFor="let request of requests">
          <div class="request-header">
            <h3>{{ request.title }}</h3>
            <span class="status-badge" [class]="'status-' + request.status?.toLowerCase()">
              {{ request.status }}
            </span>
          </div>
          <div class="request-body">
            <p class="request-description">{{ request.description }}</p>
            <div class="request-meta">
              <span class="category">
                <strong>Category:</strong> {{ request.category }}
              </span>
              <span class="date">
                <strong>Created:</strong> {{ request.created_at | date:'short' }}
              </span>
            </div>
            <!-- Status Progress -->
            <div class="status-progress">
              <div class="progress-step" [class.completed]="isStepCompleted(request.status, 'Pending')">
                <div class="step-circle">1</div>
                <span class="step-label">Pending</span>
              </div>
              <div class="progress-line" [class.completed]="isStepCompleted(request.status, 'Accepted')"></div>
              <div class="progress-step" [class.completed]="isStepCompleted(request.status, 'Accepted')">
                <div class="step-circle">2</div>
                <span class="step-label">Accepted</span>
              </div>
              <div class="progress-line" [class.completed]="isStepCompleted(request.status, 'In-progress')"></div>
              <div class="progress-step" [class.completed]="isStepCompleted(request.status, 'In-progress')">
                <div class="step-circle">3</div>
                <span class="step-label">In-Progress</span>
              </div>
              <div class="progress-line" [class.completed]="isStepCompleted(request.status, 'Completed')"></div>
              <div class="progress-step" [class.completed]="isStepCompleted(request.status, 'Completed')">
                <div class="step-circle">4</div>
                <span class="step-label">Completed</span>
              </div>
            </div>
          </div>
          <div class="request-footer">
            <button class="view-status-btn" (click)="viewRequestStatus(request.id)" type="button">
              View Status
            </button>
          </div>
        </div>
      </div>
    </section>
  </main>
</div>
