<div class="status-container">
  <div class="status-card">
    <div class="status-header">
      <button class="back-btn" (click)="goBack()" type="button">‚Üê Back to Dashboard</button>
      <h1>Request Status</h1>
    </div>

    <div class="loading" *ngIf="isLoading">
      <p>Loading request details...</p>
    </div>

    <div class="error-message" *ngIf="errorMessage">
      {{ errorMessage }}
    </div>

    <div class="status-content" *ngIf="!isLoading && request">
      <!-- Request Details -->
      <section class="request-details">
        <h2>{{ request.title }}</h2>
        <div class="detail-row">
          <span class="label">Category:</span>
          <span class="value">{{ request.category }}</span>
        </div>
        <div class="detail-row">
          <span class="label">Created:</span>
          <span class="value">{{ request.created_at | date:'medium' }}</span>
        </div>
        <div class="detail-row">
          <span class="label">Last Updated:</span>
          <span class="value">{{ request.updated_at | date:'medium' }}</span>
        </div>
        <div class="detail-row">
          <span class="label">Current Status:</span>
          <span class="status-badge" [class]="'status-' + request.status?.toLowerCase()">
            {{ request.status }}
          </span>
        </div>
      </section>

      <!-- Description -->
      <section class="description-section">
        <h3>Description</h3>
        <p>{{ request.description }}</p>
      </section>

      <!-- Helper Info -->
      <section class="helper-section" *ngIf="request.helper_name">
        <h3>Assigned Helper</h3>
        <div class="helper-card">
          <div class="helper-icon">üë§</div>
          <div class="helper-info">
            <p class="helper-name">{{ request.helper_name }}</p>
            <p class="helper-label">Community Helper</p>
          </div>
          <button class="chat-btn" (click)="openChat()" type="button" *ngIf="request.status !== 'Pending'">
            üí¨ Chat
          </button>
        </div>
      </section>

      <section class="helper-section" *ngIf="!request.helper_name && request.status === 'Pending'">
        <div class="waiting-message">
          <p>‚è≥ Waiting for a helper to accept your request...</p>
        </div>
      </section>

      <!-- Status Timeline -->
      <section class="timeline-section">
        <h3>Progress Timeline</h3>
        <div class="timeline">
          <div class="timeline-item" [class.completed]="isStepCompleted('Pending')">
            <div class="timeline-marker">
              <div class="marker-circle">1</div>
            </div>
            <div class="timeline-content">
              <h4>Request Submitted</h4>
              <p>Your request has been posted and is waiting for a helper</p>
              <span class="timeline-status">Pending</span>
            </div>
          </div>

          <div class="timeline-item" [class.completed]="isStepCompleted('Accepted')">
            <div class="timeline-marker">
              <div class="marker-circle">2</div>
            </div>
            <div class="timeline-content">
              <h4>Request Accepted</h4>
              <p>A helper has accepted your request</p>
              <span class="timeline-status">Accepted</span>
            </div>
          </div>

          <div class="timeline-item" [class.completed]="isStepCompleted('In-progress')">
            <div class="timeline-marker">
              <div class="marker-circle">3</div>
            </div>
            <div class="timeline-content">
              <h4>In Progress</h4>
              <p>The helper is working on your request</p>
              <span class="timeline-status">In-Progress</span>
            </div>
          </div>

          <div class="timeline-item" [class.completed]="isStepCompleted('Completed')">
            <div class="timeline-marker">
              <div class="marker-circle">4</div>
            </div>
            <div class="timeline-content">
              <h4>Completed</h4>
              <p>Your request has been successfully completed</p>
              <span class="timeline-status">Completed</span>
            </div>
          </div>
        </div>
      </section>

      <!-- Attachments -->
      <section class="attachments-section" *ngIf="request.attachments">
        <h3>Attachments</h3>
        <p class="attachment-link">{{ request.attachments }}</p>
      </section>
    </div>
  </div>
</div>
