<div class="admin-container">
  <!-- Sidebar -->
  <aside class="sidebar" [class.collapsed]="isSidebarCollapsed">
    <div class="sidebar-header">
      <h2>Admin Panel</h2>
      <button class="toggle-btn" (click)="toggleSidebar()" type="button">â˜°</button>
    </div>

    <nav class="sidebar-nav">
      <a routerLink="/admin" routerLinkActive="active" [routerLinkActiveOptions]="{exact: true}" class="nav-item">
        <span class="nav-icon">ğŸ“Š</span>
        <span class="nav-text">Dashboard</span>
      </a>
      <a routerLink="/admin/users" routerLinkActive="active" class="nav-item">
        <span class="nav-icon">ğŸ‘¥</span>
        <span class="nav-text">Users</span>
      </a>
      <a routerLink="/admin/requests" routerLinkActive="active" class="nav-item">
        <span class="nav-icon">ğŸ“‹</span>
        <span class="nav-text">Requests</span>
      </a>
      <a routerLink="/admin/analytics" routerLinkActive="active" class="nav-item">
        <span class="nav-icon">ğŸ“ˆ</span>
        <span class="nav-text">Analytics</span>
      </a>
      <a (click)="logout()" class="nav-item logout">
        <span class="nav-icon">ğŸšª</span>
        <span class="nav-text">Logout</span>
      </a>
    </nav>
  </aside>

  <!-- Main Content -->
  <main class="main-content">
    <!-- Header -->
    <header class="dashboard-header">
      <div class="header-content">
        <div>
          <h1>Admin Dashboard</h1>
          <p>System overview and analytics</p>
        </div>
        <div class="admin-badge">
          <span class="badge-icon">ğŸ›¡ï¸</span>
          <span class="badge-text">Administrator</span>
        </div>
      </div>
    </header>

    <!-- Loading State -->
    <div class="loading-container" *ngIf="isLoading">
      <div class="loading-spinner"></div>
      <p>Loading dashboard data...</p>
    </div>

    <!-- Dashboard Content -->
    <div class="dashboard-content" *ngIf="!isLoading">
      <!-- Analytics Overview Cards -->
      <section class="analytics-cards">
        <div class="stat-card total-users">
          <div class="card-icon">ğŸ‘¥</div>
          <div class="card-content">
            <h3>Total Users</h3>
            <p class="card-number">{{ totalUsers }}</p>
            <span class="card-label">Platform members</span>
          </div>
        </div>

        <div class="stat-card residents">
          <div class="card-icon">ğŸ </div>
          <div class="card-content">
            <h3>Residents</h3>
            <p class="card-number">{{ totalResidents }}</p>
            <span class="card-label">Active residents</span>
          </div>
        </div>

        <div class="stat-card helpers">
          <div class="card-icon">ğŸ¤</div>
          <div class="card-content">
            <h3>Helpers</h3>
            <p class="card-number">{{ totalHelpers }}</p>
            <span class="card-label">Community helpers</span>
          </div>
        </div>

        <div class="stat-card total-requests">
          <div class="card-icon">ğŸ“‹</div>
          <div class="card-content">
            <h3>Total Requests</h3>
            <p class="card-number">{{ totalRequests }}</p>
            <span class="card-label">All time</span>
          </div>
        </div>

        <div class="stat-card completed">
          <div class="card-icon">âœ…</div>
          <div class="card-content">
            <h3>Completed</h3>
            <p class="card-number">{{ completedRequests }}</p>
            <span class="card-label">Successfully finished</span>
          </div>
        </div>

        <div class="stat-card pending">
          <div class="card-icon">â³</div>
          <div class="card-content">
            <h3>Pending</h3>
            <p class="card-number">{{ pendingRequests }}</p>
            <span class="card-label">Awaiting helpers</span>
          </div>
        </div>
      </section>

      <!-- Request Status Distribution -->
      <section class="status-distribution">
        <h2>Request Status Distribution</h2>
        <div class="status-grid">
          <div class="status-item status-pending">
            <div class="status-bar">
              <div class="status-fill" [style.width.%]="(pendingRequests / totalRequests) * 100"></div>
            </div>
            <div class="status-info">
              <span class="status-label">Pending</span>
              <span class="status-count">{{ pendingRequests }}</span>
            </div>
          </div>

          <div class="status-item status-accepted">
            <div class="status-bar">
              <div class="status-fill" [style.width.%]="(acceptedRequests / totalRequests) * 100"></div>
            </div>
            <div class="status-info">
              <span class="status-label">Accepted</span>
              <span class="status-count">{{ acceptedRequests }}</span>
            </div>
          </div>

          <div class="status-item status-in-progress">
            <div class="status-bar">
              <div class="status-fill" [style.width.%]="(inProgressRequests / totalRequests) * 100"></div>
            </div>
            <div class="status-info">
              <span class="status-label">In-Progress</span>
              <span class="status-count">{{ inProgressRequests }}</span>
            </div>
          </div>

          <div class="status-item status-completed">
            <div class="status-bar">
              <div class="status-fill" [style.width.%]="(completedRequests / totalRequests) * 100"></div>
            </div>
            <div class="status-info">
              <span class="status-label">Completed</span>
              <span class="status-count">{{ completedRequests }}</span>
            </div>
          </div>
        </div>
      </section>

      <!-- Recent Requests -->
      <section class="recent-requests">
        <div class="section-header">
          <h2>Recent Help Requests</h2>
          <a routerLink="/admin/requests" class="view-all-btn">View All â†’</a>
        </div>

        <div class="no-data" *ngIf="recentRequests.length === 0">
          <p>No requests found</p>
        </div>

        <div class="requests-table" *ngIf="recentRequests.length > 0">
          <table>
            <thead>
              <tr>
                <th>ID</th>
                <th>Title</th>
                <th>Category</th>
                <th>Resident</th>
                <th>Helper</th>
                <th>Status</th>
                <th>Date</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let request of recentRequests">
                <td>#{{ request.id }}</td>
                <td class="title-cell">{{ request.title }}</td>
                <td><span class="category-badge">{{ request.category }}</span></td>
                <td>{{ request.resident_name || 'N/A' }}</td>
                <td>{{ request.helper_name || 'Unassigned' }}</td>
                <td>
                  <span class="status-badge" [ngClass]="getStatusClass(request.status)">
                    {{ request.status }}
                  </span>
                </td>
                <td>{{ request.created_at | date:'short' }}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- Quick Actions -->
      <section class="quick-actions">
        <h2>Quick Actions</h2>
        <div class="actions-grid">
          <a routerLink="/admin/users" class="action-card">
            <div class="action-icon">ğŸ‘¥</div>
            <h3>Manage Users</h3>
            <p>View and manage all platform users</p>
          </a>

          <a routerLink="/admin/requests" class="action-card">
            <div class="action-icon">ğŸ“‹</div>
            <h3>View Requests</h3>
            <p>Monitor all help requests</p>
          </a>

          <a routerLink="/admin/analytics" class="action-card">
            <div class="action-icon">ğŸ“ˆ</div>
            <h3>Analytics</h3>
            <p>View detailed platform statistics</p>
          </a>

          <a routerLink="/profile" class="action-card">
            <div class="action-icon">âš™ï¸</div>
            <h3>Settings</h3>
            <p>Configure admin preferences</p>
          </a>
        </div>
      </section>
    </div>
  </main>
</div>
